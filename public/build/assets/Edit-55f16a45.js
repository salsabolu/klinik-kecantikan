import{i as U,l as R,u as K,r as g,m as M,B as p,G as I,o as l,c as r,a as L,d as e,t as d,h as _,f as J,g as u,p as w,n as m,F as f,E as x,e as c,v as V,w as W,D as G,H as B,q as X}from"./app-807f60dc.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const Q={components:{Head:U,Link:R},props:{reservation:Object,patients:Array,services:Array,doctors:Array,errors:Object},setup(o){const i=n=>n?new Date(n).toISOString().split("T")[0]:"",s=K({patient_id:o.reservation.patient_id,service_id:o.reservation.service_id,user_id:o.reservation.user_id,tanggal_reservasi:i(o.reservation.tanggal_reservasi),waktu_mulai:o.reservation.waktu_mulai,waktu_selesai:o.reservation.waktu_selesai,status:o.reservation.status,catatan:o.reservation.catatan||""}),t=g([]),v=g(!1),y=g({waktu_mulai:o.reservation.waktu_mulai,waktu_selesai:o.reservation.waktu_selesai}),S=M(()=>o.services.find(n=>n.id==s.service_id)),C=M(()=>new Date().toISOString().split("T")[0]),h=()=>{s.tanggal_reservasi&&s.user_id&&a()},a=async()=>{var n;if(!s.tanggal_reservasi||!s.user_id||!s.service_id){t.value=[];return}v.value=!0;try{const k=await G.get("/api/available-slots",{params:{date:s.tanggal_reservasi,doctor_id:s.user_id,service_id:s.service_id,exclude_reservation_id:o.reservation.id},headers:{"X-CSRF-TOKEN":(n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},withCredentials:!0});t.value=k.data.slots||[];const D={waktu_mulai:o.reservation.waktu_mulai,waktu_selesai:o.reservation.waktu_selesai};t.value.some(b=>b.waktu_mulai===D.waktu_mulai&&b.waktu_selesai===D.waktu_selesai)||(t.value.push(D),t.value.sort((b,O)=>b.waktu_mulai.localeCompare(O.waktu_mulai)))}catch(k){console.error("Error loading available slots:",k),t.value=[]}finally{v.value=!1}},j=n=>{y.value=n,s.waktu_mulai=n.waktu_mulai,s.waktu_selesai=n.waktu_selesai},H=n=>new Date(n).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),P=n=>new Date(`2000-01-01 ${n}`).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}),q=n=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR"}).format(n),E=()=>{s.put(route("reservations.update",o.reservation.id))},T=g(!1),A=()=>{const n={patient_id:o.reservation.patient_id,service_id:o.reservation.service_id,user_id:o.reservation.user_id,tanggal_reservasi:i(o.reservation.tanggal_reservasi),waktu_mulai:o.reservation.waktu_mulai,waktu_selesai:o.reservation.waktu_selesai,status:o.reservation.status,catatan:o.reservation.catatan||""};return s.patient_id!==n.patient_id||s.service_id!==n.service_id||s.user_id!==n.user_id||s.tanggal_reservasi!==n.tanggal_reservasi||s.waktu_mulai!==n.waktu_mulai||s.waktu_selesai!==n.waktu_selesai||s.status!==n.status||s.catatan!==n.catatan},F=()=>{A()?T.value=!0:B.visit(route("reservations.index"))},N=()=>{A()?T.value=!0:B.visit(route("reservations.index"))},z=()=>{B.visit(route("reservations.index"))};return p(()=>{a()}),{form:s,availableSlots:t,loadingSlots:v,selectedTimeSlot:y,selectedService:S,minDate:C,updateServiceInfo:h,loadAvailableSlots:a,selectTimeSlot:j,formatDate:H,formatTime:P,formatCurrency:q,submit:E,processing:M(()=>s.processing),showCancelModal:T,handleBack:F,handleCancel:N,confirmCancel:z}}},Z={class:"py-12"},$={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},ee={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},te={class:"p-6 text-gray-900"},ae={class:"flex justify-between items-center mb-6"},se={class:"text-2xl font-semibold"},ie={class:"flex space-x-2"},ne=e("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={class:"form-control"},re=e("label",{class:"label"},[e("span",{class:"label-text"},[_("Pasien "),e("span",{class:"text-red-500"},"*")])],-1),de=e("option",{value:""},"Pilih Pasien",-1),ce=["value"],_e={key:0,class:"label"},ue={class:"label-text-alt text-red-500"},me={class:"form-control"},ve=e("label",{class:"label"},[e("span",{class:"label-text"},[_("Layanan "),e("span",{class:"text-red-500"},"*")])],-1),he=e("option",{value:""},"Pilih Layanan",-1),ke=["value"],be={key:0,class:"label"},ge={class:"label-text-alt text-red-500"},we={key:1,class:"alert alert-info mt-2"},fe=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),xe={class:"font-bold"},ye={class:"text-xs"},Se={class:"text-xs mt-1"},Ce={class:"form-control"},Te=e("label",{class:"label"},[e("span",{class:"label-text"},[_("Tanggal Reservasi "),e("span",{class:"text-red-500"},"*")])],-1),De=["min"],Me={key:0,class:"label"},Be={class:"label-text-alt text-red-500"},je={class:"form-control"},Ae=e("label",{class:"label"},[e("span",{class:"label-text"},[_("Dokter/Terapis "),e("span",{class:"text-red-500"},"*")])],-1),Ie=e("option",{value:""},"Pilih Dokter/Terapis",-1),Le=["value"],Ve={key:0,class:"label"},He={class:"label-text-alt text-red-500"},Pe={class:"form-control"},qe=e("label",{class:"label"},[e("span",{class:"label-text"},[_("Status "),e("span",{class:"text-red-500"},"*")])],-1),Ee=e("option",{value:"pending"},"Pending",-1),Fe=e("option",{value:"confirmed"},"Dikonfirmasi",-1),Ne=e("option",{value:"completed"},"Selesai",-1),ze=e("option",{value:"cancelled"},"Dibatalkan",-1),Oe=[Ee,Fe,Ne,ze],Ue={key:0,class:"label"},Re={class:"label-text-alt text-red-500"},Ke={class:"alert alert-info"},pe=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Je=e("h3",{class:"font-bold"},"Jadwal Saat Ini",-1),We={class:"text-xs"},Ge={key:0,class:"form-control"},Xe=e("label",{class:"label"},[e("span",{class:"label-text"},[_("Waktu Tersedia "),e("span",{class:"text-red-500"},"*")])],-1),Ye={key:0,class:"flex justify-center py-4"},Qe=e("span",{class:"loading loading-spinner loading-md"},null,-1),Ze=[Qe],$e={key:1,class:"grid grid-cols-3 md:grid-cols-6 gap-2"},et=["onClick"],tt={key:0,class:"text-xs ml-1"},at={key:2,class:"alert alert-warning"},st=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})],-1),it=e("span",null,"Tidak ada slot waktu tersedia untuk tanggal dan dokter yang dipilih.",-1),nt=[st,it],ot={key:3,class:"label"},lt={class:"label-text-alt text-red-500"},rt={key:1,class:"alert alert-success"},dt=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),ct=e("h3",{class:"font-bold"},"Waktu Terpilih",-1),_t={class:"text-xs"},ut={class:"form-control"},mt=e("label",{class:"label"},[e("span",{class:"label-text"},"Catatan (Opsional)")],-1),vt={class:"flex justify-end space-x-4"},ht=["disabled"],kt={key:0,class:"loading loading-spinner loading-sm"},bt={key:0,class:"modal modal-open"},gt={class:"modal-box"},wt=X('<h3 class="font-bold text-lg mb-4"><svg class="w-6 h-6 inline-block mr-2 text-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> Konfirmasi Perubahan </h3><p class="py-4 text-base-content/80"> Anda telah mengisi beberapa data pada form reservasi ini. Jika Anda keluar sekarang, semua perubahan akan hilang. </p><p class="text-sm text-base-content/60 mb-6"> Apakah Anda yakin ingin meninggalkan halaman ini tanpa menyimpan perubahan? </p>',3),ft={class:"modal-action"},xt=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 17l-5-5m0 0l5-5m-5 5h12"})],-1),yt=e("svg",{class:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1"})],-1);function St(o,i,s,t,v,y){var h;const S=I("Head"),C=I("Link");return l(),r("div",null,[L(S,{title:"Edit Reservasi"}),e("div",Z,[e("div",$,[e("div",ee,[e("div",te,[e("div",ae,[e("h2",se,"Edit Reservasi #"+d(s.reservation.id),1),e("div",ie,[e("button",{onClick:i[0]||(i[0]=(...a)=>t.handleBack&&t.handleBack(...a)),type:"button",class:"btn btn-outline"},[ne,_(" Kembali ")])])]),e("form",{onSubmit:i[11]||(i[11]=J((...a)=>t.submit&&t.submit(...a),["prevent"])),class:"space-y-6"},[e("div",oe,[e("div",le,[re,u(e("select",{"onUpdate:modelValue":i[1]||(i[1]=a=>t.form.patient_id=a),class:m(["select select-bordered",{"select-error":s.errors.patient_id}]),required:""},[de,(l(!0),r(f,null,x(s.patients,a=>(l(),r("option",{key:a.id,value:a.id},d(a.nama_lengkap)+" - "+d(a.nomor_telepon),9,ce))),128))],2),[[w,t.form.patient_id]]),s.errors.patient_id?(l(),r("div",_e,[e("span",ue,d(s.errors.patient_id),1)])):c("",!0)]),e("div",me,[ve,u(e("select",{"onUpdate:modelValue":i[2]||(i[2]=a=>t.form.service_id=a),class:m(["select select-bordered",{"select-error":s.errors.service_id}]),onChange:i[3]||(i[3]=(...a)=>t.updateServiceInfo&&t.updateServiceInfo(...a)),required:""},[he,(l(!0),r(f,null,x(s.services,a=>(l(),r("option",{key:a.id,value:a.id},d(a.nama_layanan)+" - "+d(t.formatCurrency(a.harga)),9,ke))),128))],34),[[w,t.form.service_id]]),s.errors.service_id?(l(),r("div",be,[e("span",ge,d(s.errors.service_id),1)])):c("",!0),t.selectedService?(l(),r("div",we,[e("div",null,[fe,e("div",null,[e("h3",xe,d(t.selectedService.nama_layanan),1),e("div",ye," Durasi: "+d(t.selectedService.durasi_menit)+" menit | Harga: "+d(t.formatCurrency(t.selectedService.harga)),1),e("p",Se,d(t.selectedService.deskripsi),1)])])])):c("",!0)]),e("div",Ce,[Te,u(e("input",{type:"date","onUpdate:modelValue":i[4]||(i[4]=a=>t.form.tanggal_reservasi=a),class:m(["input input-bordered",{"input-error":s.errors.tanggal_reservasi}]),min:t.minDate,onChange:i[5]||(i[5]=(...a)=>t.loadAvailableSlots&&t.loadAvailableSlots(...a)),required:""},null,42,De),[[V,t.form.tanggal_reservasi]]),s.errors.tanggal_reservasi?(l(),r("div",Me,[e("span",Be,d(s.errors.tanggal_reservasi),1)])):c("",!0)]),e("div",je,[Ae,u(e("select",{"onUpdate:modelValue":i[6]||(i[6]=a=>t.form.user_id=a),class:m(["select select-bordered",{"select-error":s.errors.user_id}]),onChange:i[7]||(i[7]=(...a)=>t.loadAvailableSlots&&t.loadAvailableSlots(...a)),required:""},[Ie,(l(!0),r(f,null,x(s.doctors,a=>(l(),r("option",{key:a.id,value:a.id},d(a.name),9,Le))),128))],34),[[w,t.form.user_id]]),s.errors.user_id?(l(),r("div",Ve,[e("span",He,d(s.errors.user_id),1)])):c("",!0)]),e("div",Pe,[qe,u(e("select",{"onUpdate:modelValue":i[8]||(i[8]=a=>t.form.status=a),class:m(["select select-bordered",{"select-error":s.errors.status}]),required:""},Oe,2),[[w,t.form.status]]),s.errors.status?(l(),r("div",Ue,[e("span",Re,d(s.errors.status),1)])):c("",!0)])]),e("div",Ke,[pe,e("div",null,[Je,e("div",We,d(t.formatDate(s.reservation.tanggal_reservasi))+" | "+d(t.formatTime(s.reservation.waktu_mulai))+" - "+d(t.formatTime(s.reservation.waktu_selesai)),1)])]),t.form.tanggal_reservasi&&t.form.user_id&&t.form.service_id?(l(),r("div",Ge,[Xe,t.loadingSlots?(l(),r("div",Ye,Ze)):t.availableSlots.length>0?(l(),r("div",$e,[(l(!0),r(f,null,x(t.availableSlots,a=>(l(),r("button",{key:a.waktu_mulai,type:"button",onClick:j=>t.selectTimeSlot(a),class:m(["btn btn-sm",{"btn-primary":t.selectedTimeSlot&&t.selectedTimeSlot.waktu_mulai===a.waktu_mulai,"btn-outline":!t.selectedTimeSlot||t.selectedTimeSlot.waktu_mulai!==a.waktu_mulai,"btn-success":a.waktu_mulai===s.reservation.waktu_mulai&&a.waktu_selesai===s.reservation.waktu_selesai}])},[_(d(t.formatTime(a.waktu_mulai))+" ",1),a.waktu_mulai===s.reservation.waktu_mulai&&a.waktu_selesai===s.reservation.waktu_selesai?(l(),r("span",tt,"(saat ini)")):c("",!0)],10,et))),128))])):(l(),r("div",at,nt)),s.errors.waktu_mulai?(l(),r("div",ot,[e("span",lt,d(s.errors.waktu_mulai),1)])):c("",!0)])):c("",!0),t.selectedTimeSlot?(l(),r("div",rt,[dt,e("div",null,[ct,e("div",_t,d(t.formatTime(t.selectedTimeSlot.waktu_mulai))+" - "+d(t.formatTime(t.selectedTimeSlot.waktu_selesai))+" ("+d((h=t.selectedService)==null?void 0:h.durasi_menit)+" menit) ",1)])])):c("",!0),e("div",ut,[mt,u(e("textarea",{"onUpdate:modelValue":i[9]||(i[9]=a=>t.form.catatan=a),class:"textarea textarea-bordered h-24",placeholder:"Catatan tambahan untuk reservasi..."},null,512),[[V,t.form.catatan]])]),e("div",vt,[e("button",{onClick:i[10]||(i[10]=(...a)=>t.handleCancel&&t.handleCancel(...a)),type:"button",class:"btn btn-outline"}," Batal "),e("button",{type:"submit",class:"btn btn-primary",disabled:t.processing},[t.processing?(l(),r("span",kt)):c("",!0),_(" "+d(t.processing?"Menyimpan...":"Simpan Perubahan"),1)],8,ht)])],32)])])])]),t.showCancelModal?(l(),r("div",bt,[e("div",gt,[wt,e("div",ft,[e("button",{onClick:i[12]||(i[12]=a=>t.showCancelModal=!1),class:"btn btn-ghost"},[xt,_(" Tetap di Halaman ")]),L(C,{href:o.route("reservations.index"),class:"btn btn-warning"},{default:W(()=>[yt,_(" Ya, Keluar ")]),_:1},8,["href"])])])])):c("",!0)])}const Mt=Y(Q,[["render",St]]);export{Mt as default};
