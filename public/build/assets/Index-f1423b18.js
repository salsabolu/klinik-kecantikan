import{r as f,H as C,m as W,o as l,k as P,w as v,a as n,b as a,i as X,d as t,l as w,h,e as m,g as z,v as D,c as i,p as Y,E as N,t as c,n as T,f as B,F as H}from"./app-807f60dc.js";import{A as Z,H as tt}from"./AppLayout-422bcc0a.js";import{_ as et}from"./ResetFilterButton-97faf3b6.js";import{l as st}from"./lodash-e23d088e.js";import{I,G as ot}from"./PhPlus.vue-ac80d116.js";import{I as at}from"./PhEye.vue-3a0a261d.js";import{G as lt}from"./PhNotePencil.vue-2f5d6dac.js";import{G as nt}from"./PhTrashSimple.vue-94343d88.js";import{F as rt}from"./PhX.vue-bddc74a7.js";import"./PhCurrencyCircleDollar.vue-370c4c60.js";import"./PhClock.vue-0bcaea51.js";import"./PhFlask.vue-b6585dea.js";import"./PhSignOut.vue-98dc8f64.js";import"./_plugin-vue_export-helper-c27b6911.js";const it={class:"space-y-6"},ct={class:"flex items-center justify-between"},dt=t("div",null,[t("h1",{class:"text-3xl font-semibold"},"Daftar Produk"),t("p",{class:"text-gray-600"},"Kelola produk klinik kecantikan")],-1),ut={class:"card bg-white shadow-xl"},_t={class:"card-body"},ht={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},mt={class:"form-control"},pt=t("label",{class:"label"},[t("span",{class:"label-text"},"Pencarian")],-1),kt={class:"relative"},bt={class:"form-control"},ft=t("label",{class:"label"},[t("span",{class:"label-text"},"Status Stok")],-1),vt=t("option",{value:""},"Semua",-1),gt=t("option",{value:"available"},"Tersedia (>0)",-1),xt=t("option",{value:"low"},"Stok Rendah (â‰¤10)",-1),wt=t("option",{value:"empty"},"Habis (0)",-1),yt=[vt,gt,xt,wt],St={class:"card bg-white shadow-xl"},Ct={class:"card-body"},$t={class:"overflow-x-auto"},jt={class:"table table-zebra"},Pt=t("thead",null,[t("tr",null,[t("th",null,"No"),t("th",null,"Nama Produk"),t("th",null,"Deskripsi"),t("th",null,"Harga"),t("th",null,"Stok"),t("th",{class:"text-center"},"Aksi")])],-1),zt=["onClick"],Mt={class:"font-semibold max-w-28"},At={class:"text-sm max-w-xs truncate"},Dt={class:"font-medium"},Nt={class:"flex items-center gap-2"},Tt=["onClick"],Bt={class:"dropdown dropdown-left"},Ht={tabindex:"0",class:"btn btn-circle btn-ghost btn-sm"},It={tabindex:"0",class:"dropdown-content menu p-2 shadow bg-white rounded-box w-40"},Vt={key:0},Ft={key:1},Gt=["onClick"],Et={key:0,class:"flex justify-center mt-8"},Ot={class:"btn-group"},Rt={key:1,class:"flex flex-col justify-center items-center text-center py-12"},Ut=t("p",{class:"text-lg font-medium text-gray-600"},"Tidak ada produk",-1),Kt=t("p",{class:"text-base text-gray-600 mb-4"},"Mulai dengan menambahkan produk baru.",-1),Lt={key:0,class:"modal modal-open"},Jt={class:"modal-box"},qt=t("p",{class:"text-lg font-semibold"},"Konfirmasi Hapus",-1),Qt={class:"mt-4"},Wt={class:"modal-action"},Xt={key:1,class:"modal modal-open"},Yt={class:"modal-box"},Zt=t("p",{class:"text-lg font-semibold"},"Sesuaikan Stok",-1),te={class:"mt-2"},ee={class:"mb-4"},se={class:"form-control space-x-2"},oe=t("label",{class:"label"},[t("span",{class:"label-text"},"Jumlah Stok Baru")],-1),fe={__name:"Index",props:{products:Object,filters:Object,auth:Object},setup(g){const d=g,$=o=>{var s,r;return(r=(s=d.auth)==null?void 0:s.user)!=null&&r.role?o.includes(d.auth.user.role):!1},u=f({search:d.filters.search||"",stok_status:d.filters.stok_status||""}),y=f(!1),j=f(!1),x=f(null),p=f(null),k=f({new_stock:""}),b=st.debounce(()=>{C.get("/products",u.value,{preserveState:!0,replace:!0})},300),V=()=>{u.value.search="",b()},F=()=>{u.value={search:"",stok_status:""},b()},G=o=>new Intl.NumberFormat("id-ID").format(o),E=o=>(d.products.current_page-1)*d.products.per_page+o+1,O=o=>{C.get(`/products/${o}`)},R=o=>o===0?"badge-error":o<=10?"badge-warning":"badge-success",U=W(()=>{const o=[],s=d.products.current_page,r=d.products.last_page;s>3&&o.push(1),s>4&&o.push("...");for(let _=Math.max(1,s-2);_<=Math.min(r,s+2);_++)o.push(_);return s<r-3&&o.push("..."),s<r-2&&o.push(r),o.filter((_,S,e)=>e.indexOf(_)===S)}),K=o=>{x.value=o,y.value=!0},L=()=>{x.value&&C.delete(`/products/${x.value.id}`,{onSuccess:()=>{y.value=!1,x.value=null}})},J=o=>{p.value=o,k.value.new_stock=o.stok,j.value=!0},M=()=>{j.value=!1,p.value=null,k.value={new_stock:""}},q=()=>{if(p.value&&k.value.new_stock>=0){const o=p.value.stok,s=k.value.new_stock;confirm(`Apakah Anda yakin ingin mengubah stok dari ${o} menjadi ${s}?`)&&C.put(`/products/${p.value.id}/adjust-stock`,{new_stock:s},{onSuccess:()=>{M(),alert(`Stok berhasil diubah dari ${o} menjadi ${s}`)}})}};return(o,s)=>(l(),P(Z,null,{default:v(()=>{var r,_,S;return[n(a(X),{title:"Produk"}),t("div",it,[t("div",ct,[dt,$(["admin","manajer_stok"])?(l(),P(a(w),{key:0,href:"/products/create",class:"btn btn-primary"},{default:v(()=>[n(a(I),{size:20,color:"black",weight:"regular"}),h(" Tambah Produk ")]),_:1})):m("",!0)]),t("div",ut,[t("div",_t,[t("div",ht,[t("div",mt,[pt,t("div",kt,[z(t("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>u.value.search=e),type:"text",placeholder:"Nama produk atau deskripsi...",class:"input input-bordered w-full",onInput:s[1]||(s[1]=(...e)=>a(b)&&a(b)(...e))},null,544),[[D,u.value.search]]),u.value.search?(l(),i("button",{key:0,onClick:V,class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[n(a(rt),{size:20,color:"grey",weight:"regular"})])):m("",!0)])]),t("div",bt,[ft,z(t("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>u.value.stok_status=e),class:"select select-bordered",onChange:s[3]||(s[3]=(...e)=>a(b)&&a(b)(...e))},yt,544),[[Y,u.value.stok_status]])]),n(et,{onReset:F})])])]),t("div",St,[t("div",Ct,[t("div",$t,[t("table",jt,[Pt,t("tbody",null,[(l(!0),i(H,null,N(g.products.data,(e,Q)=>(l(),i("tr",{key:e.id,onClick:A=>O(e.id),class:"cursor-pointer hover:bg-base-300 transition-colors"},[t("td",null,c(E(Q)),1),t("td",null,[t("div",Mt,c(e.nama_produk),1)]),t("td",null,[t("div",At,c(e.deskripsi||"-"),1)]),t("td",null,[t("div",Dt," Rp "+c(G(e.harga)),1)]),t("td",null,[t("div",Nt,[t("div",{class:T(["badge",R(e.stok)])},c(e.stok),3),t("button",{onClick:B(A=>J(e),["stop"]),class:"btn btn-outline btn-xs",title:"Sesuaikan Stok"},[n(a(I),{size:12,color:"black",weight:"bold"})],8,Tt)])]),t("td",{onClick:s[4]||(s[4]=B(()=>{},["stop"]))},[t("div",Bt,[t("label",Ht,[n(a(ot),{size:20,color:"black",weight:"bold"})]),t("ul",It,[t("li",null,[n(a(w),{href:`/products/${e.id}`},{default:v(()=>[n(a(at),{size:16,color:"black",weight:"regular"}),h(" Detail ")]),_:2},1032,["href"])]),$(["admin","manajer_stok"])?(l(),i("li",Vt,[n(a(w),{href:`/products/${e.id}/edit`},{default:v(()=>[n(a(lt),{size:16,color:"black",weight:"regular"}),h(" Edit ")]),_:2},1032,["href"])])):m("",!0),$(["admin","manajer_stok"])?(l(),i("li",Ft,[t("button",{onClick:A=>K(e),class:"text-error"},[n(a(nt),{size:16,color:"currentColor",weight:"regular"}),h(" Hapus ")],8,Gt)])):m("",!0)])])])],8,zt))),128))])])]),g.products.last_page>1?(l(),i("div",Et,[t("div",Ot,[(l(!0),i(H,null,N(U.value,e=>(l(),P(a(w),{key:e,href:`/products?page=${e}`,class:T(["btn btn-sm",{"btn-active":e===g.products.current_page}])},{default:v(()=>[h(c(e),1)]),_:2},1032,["href","class"]))),128))])])):m("",!0),g.products.data.length===0?(l(),i("div",Rt,[n(a(tt),{size:80,color:"black",weight:"regular"}),Ut,Kt,n(a(w),{href:"/products/create",class:"btn btn-primary"},{default:v(()=>[h(" Tambah Produk ")]),_:1})])):m("",!0)])])]),y.value?(l(),i("div",Lt,[t("div",Jt,[qt,t("p",Qt,[h(' Apakah Anda yakin ingin menghapus produk "'),t("strong",null,c((r=x.value)==null?void 0:r.nama_produk),1),h('"? Tindakan ini tidak dapat dibatalkan. ')]),t("div",Wt,[t("button",{onClick:s[5]||(s[5]=e=>y.value=!1),class:"btn btn-outline"},"Batal"),t("button",{onClick:L,class:"btn btn-error"},"Hapus")])])])):m("",!0),j.value?(l(),i("div",Xt,[t("div",Yt,[Zt,t("p",te,"Produk: "+c((_=p.value)==null?void 0:_.nama_produk),1),t("p",ee,"Stok saat ini: "+c((S=p.value)==null?void 0:S.stok),1),t("div",se,[oe,z(t("input",{"onUpdate:modelValue":s[6]||(s[6]=e=>k.value.new_stock=e),type:"number",min:"0",class:"input input-bordered",placeholder:"Masukkan jumlah stok baru"},null,512),[[D,k.value.new_stock]])]),t("div",{class:"modal-action"},[t("button",{onClick:M,class:"btn btn-outline"},"Batal"),t("button",{onClick:q,class:"btn btn-primary"},"Simpan")])])])):m("",!0)]}),_:1}))}};export{fe as default};
