import{r as _,m as f,K,o as l,k as it,w as rt,a as d,b as h,i as dt,d as t,g as k,p as ct,c as n,v as T,e as m,t as o,F as M,E as C,n as F,H as E}from"./app-807f60dc.js";import{A as ut,H as y}from"./AppLayout-422bcc0a.js";import{_ as $}from"./ResetFilterButton-97faf3b6.js";import{G as W}from"./PhWarning.vue-0291b903.js";import"./PhCurrencyCircleDollar.vue-370c4c60.js";import"./PhClock.vue-0bcaea51.js";import"./PhFlask.vue-b6585dea.js";import"./PhSignOut.vue-98dc8f64.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./PhX.vue-bddc74a7.js";const gt={class:"space-y-6"},_t=t("div",null,[t("h1",{class:"text-3xl font-semibold"},"Laporan Stok Produk"),t("p",{class:"text-gray-600"},"Monitoring stok dan pergerakan produk")],-1),ht={class:"card bg-white shadow-xl"},vt={class:"card-body space-y-6"},mt={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},bt={class:"form-control"},pt=t("label",{class:"label"},[t("span",{class:"label-text font-semibold"},"Periode")],-1),ft=t("option",{value:"weekly"},"Mingguan",-1),kt=t("option",{value:"monthly"},"Bulanan",-1),yt=t("option",{value:"yearly"},"Tahunan",-1),wt=t("option",{value:"custom"},"Kustom",-1),xt=[ft,kt,yt,wt],St={key:0,class:"form-control"},Dt=t("label",{class:"label"},[t("span",{class:"label-text font-semibold"},"Dari Tanggal")],-1),Pt={key:1,class:"form-control"},Tt=t("label",{class:"label"},[t("span",{class:"label-text font-semibold"},"Sampai Tanggal")],-1),Mt={class:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},Ct={class:"stat bg-gradient-to-br from-clinic-green to-green-800 text-white rounded-lg shadow-lg"},Ft={class:"stat-figure"},It=t("div",{class:"stat-title text-green-100"},"Nilai Total Stok",-1),Ot={class:"stat-value text-2xl"},jt={class:"stat bg-gradient-to-br from-red-500 to-red-600 text-white rounded-lg shadow-lg"},Vt={class:"stat-figure"},Yt=t("div",{class:"stat-title text-red-100"},"Stok Menipis",-1),zt={class:"stat-value text-2xl"},Bt={class:"stat bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg shadow-lg"},At={class:"stat-figure"},Lt=t("div",{class:"stat-title text-red-100"},"Produk Terjual",-1),Nt={class:"stat-value text-2xl"},Rt={key:0,class:"card bg-white shadow-xl"},Ht={class:"card-body space-y-6"},Ut={class:"flex items-start gap-2 text-error"},Kt=t("p",{class:"text-lg font-semibold"}," Peringatan Stok Menipis ",-1),Et={class:"alert alert-soft alert-error"},$t=t("p",{class:"font-bold"},"Perhatian!",-1),Wt={class:"text-xs"},Gt={class:"overflow-x-auto"},qt={class:"table table-sm"},Jt=t("thead",null,[t("tr",null,[t("th",null,"No"),t("th",null,"Produk"),t("th",null,"Stok Tersisa"),t("th",null,"Harga"),t("th",null,"Status")])],-1),Qt={class:"text-sm"},Xt={class:"font-semibold"},Zt={class:"text-sm text-gray-600 truncate"},te={class:"badge badge-error badge-sm"},ee={class:"font-semibold"},se={key:0,class:"badge badge-outline badge-error badge-sm"},ae={key:1,class:"badge badge-outline badge-warning badge-sm"},oe={key:2,class:"badge badge-outline badge-warning badge-sm"},le={key:0,class:"flex justify-center mt-4"},ne={class:"join"},ie=["onClick"],re={key:1,class:"card bg-white shadow-xl py-12"},de={class:"card-body space-y-6"},ce={class:"flex flex-col justify-center items-center text-center"},ue=t("p",{class:"text-lg font-medium text-gray-600"},"Stok Aman",-1),ge={class:"text-base text-gray-600 mb-4"},_e={class:"card bg-white shadow-xl"},he={class:"card-body space-y-6"},ve={class:"flex items-start gap-2"},me=t("p",{class:"text-lg font-semibold"}," Pergerakan Produk Bulan Ini ",-1),be={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},pe={class:"form-control"},fe=t("label",{for:"movement-start-date",class:"label"},[t("span",{class:"label-text font-semibold"},"Dari Tanggal")],-1),ke={class:"form-control"},ye=t("label",{for:"movement-end-date",class:"label"},[t("span",{class:"label-text font-semibold"},"Sampai Tanggal")],-1),we={class:"overflow-x-auto"},xe={class:"table table-sm"},Se=t("thead",null,[t("tr",null,[t("th",null,"No"),t("th",null,"Produk"),t("th",null,"Stok Saat Ini"),t("th",null,"Total Terjual"),t("th",null,"Total Pendapatan"),t("th",null,"Rata-rata per Transaksi"),t("th",null,"Status Stok")])],-1),De={class:"text-sm font-normal"},Pe={class:"font-semibold"},Te={class:"font-semibold text-blue-600"},Me={class:"font-semibold text-green-600"},Ce={class:"text-gray-600"},Fe={key:0,class:"flex justify-center mt-4"},Ie={class:"join"},Oe=["onClick"],je={key:1,class:"text-center py-12"},Ve={class:"flex flex-col justify-center items-center text-center"},Ye=t("p",{class:"text-lg font-medium text-gray-600"},"Belum Ada Pergerakan Produk",-1),ze=t("p",{class:"text-base text-gray-600 mb-4"},"Belum ada penjualan produk bulan ini.",-1),I=10,w=10,We={__name:"Stock",props:{lowStockProducts:{type:Array,default:()=>[]},productMovement:{type:Array,default:()=>[]},stockValue:{type:Object,default:()=>({total_value:0})},filters:{type:Object,default:()=>({})}},setup(g){var N,R,H,U;const b=g,p=_("monthly"),i=_(((N=b.filters)==null?void 0:N.start_date)||""),r=_(((R=b.filters)==null?void 0:R.end_date)||""),x=_(10),c=_(((H=b.filters)==null?void 0:H.movement_start_date)||""),u=_(((U=b.filters)==null?void 0:U.movement_end_date)||""),S=_(1),D=_(1),G=()=>{const s=new Date,a=new Date(s.getFullYear(),s.getMonth(),1),e=new Date(s.getFullYear(),s.getMonth()+1,0);i.value||(i.value=a.toISOString().split("T")[0]),r.value||(r.value=e.toISOString().split("T")[0]),c.value||(c.value=a.toISOString().split("T")[0]),u.value||(u.value=e.toISOString().split("T")[0])},O=()=>{const s=new Date;switch(p.value){case"weekly":const a=new Date(s.setDate(s.getDate()-s.getDay())),e=new Date(s.setDate(s.getDate()-s.getDay()+6));i.value=a.toISOString().split("T")[0],r.value=e.toISOString().split("T")[0];break;case"monthly":const v=new Date(s.getFullYear(),s.getMonth(),1),ot=new Date(s.getFullYear(),s.getMonth()+1,0);i.value=v.toISOString().split("T")[0],r.value=ot.toISOString().split("T")[0];break;case"yearly":const lt=new Date(s.getFullYear(),0,1),nt=new Date(s.getFullYear(),11,31);i.value=lt.toISOString().split("T")[0],r.value=nt.toISOString().split("T")[0];break}};G(),O();const z=f(()=>b.lowStockProducts||[]),j=f(()=>b.productMovement||[]),q=f(()=>{const s=(S.value-1)*I,a=s+I;return z.value.slice(s,a)}),J=f(()=>{const s=(D.value-1)*w,a=s+w;return j.value.slice(s,a)}),B=f(()=>{const s=Math.ceil(z.value.length/I),a=[];for(let e=1;e<=s;e++)a.push(e);return a}),Q=f(()=>{const s=Math.ceil(j.value.length/w),a=[];for(let e=1;e<=s;e++)a.push(e);return a});K([i,r],()=>{i.value&&r.value&&P()},{immediate:!1}),K([c,u],()=>{c.value&&u.value&&Y()},{immediate:!1});const V=s=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s),X=()=>{O(),i.value&&r.value&&P()},A=()=>{i.value&&r.value&&P()},L=()=>{c.value&&u.value&&Y()},P=()=>{E.get(route("reports.stock"),{start_date:i.value,end_date:r.value,threshold:x.value},{preserveState:!0,preserveScroll:!0,replace:!0})},Y=()=>{E.get(route("reports.stock"),{movement_start_date:c.value,movement_end_date:u.value,threshold:x.value},{preserveState:!0,preserveScroll:!0,replace:!0})},Z=s=>s===0?"badge-error":s<5||s<10?"badge-warning":"badge-success",tt=s=>s===0?"badge-error":s<5||s<10?"badge-warning":"badge-success",et=s=>s===0?"Habis":s<5?"Kritis":s<10?"Rendah":"Aman",st=()=>{p.value="monthly",O(),P()},at=()=>{const s=new Date,a=new Date(s.getFullYear(),s.getMonth(),1),e=new Date(s.getFullYear(),s.getMonth()+1,0);c.value=a.toISOString().split("T")[0],u.value=e.toISOString().split("T")[0],Y()};return(s,a)=>(l(),it(ut,null,{default:rt(()=>[d(h(dt),{title:"Laporan Stok"}),t("div",gt,[_t,t("div",ht,[t("div",vt,[t("div",mt,[t("div",bt,[pt,k(t("select",{"onUpdate:modelValue":a[0]||(a[0]=e=>p.value=e),onChange:X,class:"select select-bordered"},xt,544),[[ct,p.value]])]),p.value==="custom"?(l(),n("div",St,[Dt,k(t("input",{type:"date","onUpdate:modelValue":a[1]||(a[1]=e=>i.value=e),onChange:A,class:"input input-bordered",autocomplete:"off"},null,544),[[T,i.value]])])):m("",!0),p.value==="custom"?(l(),n("div",Pt,[Tt,k(t("input",{type:"date","onUpdate:modelValue":a[2]||(a[2]=e=>r.value=e),onChange:A,class:"input input-bordered",autocomplete:"off"},null,544),[[T,r.value]])])):m("",!0),d($,{onReset:st})]),t("div",Mt,[t("div",Ct,[t("div",Ft,[d(h(y),{size:40,color:"white",weight:"regular"})]),It,t("div",Ot,o(V(g.stockValue.total_value||0)),1)]),t("div",jt,[t("div",Vt,[d(h(W),{size:40,color:"white",weight:"regular"})]),Yt,t("div",zt,o(g.lowStockProducts.length),1)]),t("div",Bt,[t("div",At,[d(h(y),{size:40,color:"white",weight:"regular"})]),Lt,t("div",Nt,o(g.productMovement.length),1)])])])]),g.lowStockProducts.length>0?(l(),n("div",Rt,[t("div",Ht,[t("div",Ut,[d(h(W),{size:30,color:"currentColor",weight:"regular"}),Kt]),t("div",Et,[t("div",null,[$t,t("div",Wt,o(g.lowStockProducts.length)+" produk memiliki stok di bawah "+o(x.value)+" unit. Segera lakukan restocking.",1)])]),t("div",Gt,[t("table",qt,[Jt,t("tbody",null,[(l(!0),n(M,null,C(q.value,(e,v)=>(l(),n("tr",{key:e.id,class:"hover"},[t("td",null,[t("span",Qt,o((S.value-1)*I+v+1),1)]),t("td",null,[t("div",Xt,o(e.nama_produk),1),t("div",Zt,o(e.deskripsi),1)]),t("td",null,[t("span",te,o(e.stok)+" unit",1)]),t("td",null,[t("span",ee,o(V(e.harga)),1)]),t("td",null,[e.stok===0?(l(),n("span",se," Habis ")):e.stok<5?(l(),n("span",ae," Kritis ")):(l(),n("span",oe," Rendah "))])]))),128))])]),B.value.length>1?(l(),n("div",le,[t("div",ne,[(l(!0),n(M,null,C(B.value,e=>(l(),n("button",{key:e,onClick:v=>S.value=e,class:F(["join-item btn btn-sm",{"btn-active":e===S.value}])},o(e),11,ie))),128))])])):m("",!0)])])])):m("",!0),g.lowStockProducts.length===0?(l(),n("div",re,[t("div",de,[t("div",ce,[d(h(y),{size:80,color:"black",weight:"regular"}),ue,t("p",ge,"Semua produk memiliki stok yang cukup (di atas "+o(x.value)+" unit).",1)])])])):m("",!0),t("div",_e,[t("div",he,[t("div",ve,[d(h(y),{size:30,color:"currentColor",weight:"regular"}),me]),t("div",be,[t("div",pe,[fe,k(t("input",{id:"movement-start-date","onUpdate:modelValue":a[3]||(a[3]=e=>c.value=e),onChange:L,type:"date",class:"input input-bordered"},null,544),[[T,c.value]])]),t("div",ke,[ye,k(t("input",{id:"movement-end-date","onUpdate:modelValue":a[4]||(a[4]=e=>u.value=e),onChange:L,type:"date",class:"input input-bordered"},null,544),[[T,u.value]])]),d($,{text:"Reset",onReset:at})]),t("div",we,[t("table",xe,[Se,t("tbody",null,[(l(!0),n(M,null,C(J.value,(e,v)=>(l(),n("tr",{key:e.nama_produk,class:"hover"},[t("th",null,[t("span",De,o((D.value-1)*w+v+1),1)]),t("td",null,[t("div",Pe,o(e.nama_produk),1)]),t("td",null,[t("span",{class:F(["badge badge-sm",Z(e.stok)])},o(e.stok)+" unit ",3)]),t("td",null,[t("span",Te,o(e.total_sold)+" unit",1)]),t("td",null,[t("span",Me,o(V(e.total_revenue||0)),1)]),t("td",null,[t("span",Ce,o(parseFloat(e.avg_sold_per_transaction).toFixed(1))+" unit",1)]),t("td",null,[t("span",{class:F(["badge badge-outline badge-sm",tt(e.stok)])},o(et(e.stok)),3)])]))),128))])])]),j.value.length>w?(l(),n("div",Fe,[t("div",Ie,[(l(!0),n(M,null,C(Q.value,e=>(l(),n("button",{key:e,onClick:v=>D.value=e,class:F(["join-item btn btn-sm",{"btn-active":e===D.value}])},o(e),11,Oe))),128))])])):m("",!0),g.productMovement.length===0?(l(),n("div",je,[t("div",Ve,[d(h(y),{size:80,color:"black",weight:"regular"}),Ye,ze])])):m("",!0)])])])]),_:1}))}};export{We as default};
